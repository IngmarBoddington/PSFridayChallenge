/*
Copyright (c) AppDynamics, Inc., and its affiliates
2019
All Rights Reserved
 */
'use strict';

var uuid = require('uuid');

function Eum(agentConfigResponse) {
  this.agentConfigResponse = agentConfigResponse;
  this.globalAccountName = null;

  // GUID generation
  this.uuidBase = uuid.v4();
  this.nextEumCookieId = 1;
  this.eumCookie = require('./eum-cookie').EumCookie;

  this.enabled = false;
}
exports.Eum = Eum;

Eum.prototype.generateGuid = function () {
  var self = this;

  return (self.uuidBase + (self.nextEumCookieId++));
};

Eum.prototype.newEumCookie = function (transaction, reqHeaders, lambdaResponse) {
  var self = this;

  return new self.eumCookie(self, transaction, reqHeaders, lambdaResponse);
};

Eum.prototype.setEnabled = function (value) {
  this.enabled = value;
}

Eum.prototype.getGlobalAccountName = function () {
  if (!this.globalAccountName)
    this.globalAccountName = this.agentConfigResponse.getGlobalAccountName();
  return this.globalAccountName;
}
